[gd_scene load_steps=17 format=3 uid="uid://du6ct0ka5dq5v"]

[ext_resource type="Script" uid="uid://biiohlgkkxbmu" path="res://scenes/units/player/player.gd" id="1_sa5jc"]
[ext_resource type="PackedScene" uid="uid://j1kdwnla04va" path="res://scenes/ui/tile_marker.tscn" id="2_c7ys8"]
[ext_resource type="PackedScene" uid="uid://6dm6gbcd1lw5" path="res://scenes/equipment/weapons/knife.tscn" id="2_iddm0"]
[ext_resource type="PackedScene" uid="uid://dho4hm43tv7tw" path="res://scenes/components/common/health.tscn" id="2_x7qu0"]
[ext_resource type="PackedScene" uid="uid://b77rswxv1lqus" path="res://scenes/animations/animation_player.tscn" id="3_minvm"]
[ext_resource type="PackedScene" uid="uid://dgs5wqmk1858f" path="res://scenes/states/state_machine.tscn" id="4_pw8sp"]
[ext_resource type="PackedScene" uid="uid://cnmv1vac1726e" path="res://scenes/states/state_idle.tscn" id="5_iddm0"]
[ext_resource type="PackedScene" uid="uid://plpm7ofw6w85" path="res://scenes/states/state_walk.tscn" id="6_x7qu0"]
[ext_resource type="PackedScene" uid="uid://dcdvfuy1gvybq" path="res://scenes/AI/AI.tscn" id="7_rb86x"]
[ext_resource type="PackedScene" uid="uid://b7ltulumdkfkt" path="res://scenes/AI/actions/action_idle.tscn" id="8_g0wty"]
[ext_resource type="PackedScene" uid="uid://b4ykuqbuxa4fn" path="res://scenes/states/state_follow.tscn" id="8_x7qu0"]
[ext_resource type="PackedScene" uid="uid://dd0rgb4upb4og" path="res://scenes/AI/actions/action_walk.tscn" id="9_fayx6"]
[ext_resource type="PackedScene" uid="uid://cf6vbk6uigwo2" path="res://scenes/states/state_attack_meele.tscn" id="9_rb86x"]
[ext_resource type="PackedScene" uid="uid://ccswq5ld6w2qi" path="res://scenes/AI/actions/action_attack_meele.tscn" id="11_g0wty"]
[ext_resource type="PackedScene" uid="uid://cn5qo6tf5t5mx" path="res://scenes/states/state_dead.tscn" id="11_rb86x"]

[sub_resource type="CapsuleShape2D" id="CapsuleShape2D_iddm0"]
radius = 4.0
height = 10.0

[node name="Player" type="Area2D" node_paths=PackedStringArray("animation", "state_machine", "ai", "health", "weapon", "turn_start_delay")]
script = ExtResource("1_sa5jc")
animation = NodePath("AnimationPlayer")
state_machine = NodePath("StateMachine")
ai = NodePath("AI")
speed = 1
health = NodePath("Health")
weapon = NodePath("Knife")
turn_start_delay = NodePath("TurnStartDelay")

[node name="Health" parent="." node_paths=PackedStringArray("unit") instance=ExtResource("2_x7qu0")]
max = 100
unit = NodePath("..")

[node name="Camera2D" type="Camera2D" parent="."]

[node name="Knife" parent="." node_paths=PackedStringArray("unit") instance=ExtResource("2_iddm0")]
unit = NodePath("..")

[node name="TileMarker" parent="." node_paths=PackedStringArray("unit") instance=ExtResource("2_c7ys8")]
unit = NodePath("..")

[node name="AnimationPlayer" parent="." instance=ExtResource("3_minvm")]

[node name="StateMachine" parent="." node_paths=PackedStringArray("initial_state") instance=ExtResource("4_pw8sp")]
initial_state = NodePath("StateIdle")

[node name="StateIdle" parent="StateMachine" node_paths=PackedStringArray("unit") instance=ExtResource("5_iddm0")]
unit = NodePath("../..")

[node name="StateWalk" parent="StateMachine" node_paths=PackedStringArray("unit") instance=ExtResource("6_x7qu0")]
unit = NodePath("../..")

[node name="StateFollow" parent="StateMachine" node_paths=PackedStringArray("unit") instance=ExtResource("8_x7qu0")]
unit = NodePath("../..")

[node name="StateAttackMeele" parent="StateMachine" node_paths=PackedStringArray("unit") instance=ExtResource("9_rb86x")]
unit = NodePath("../..")

[node name="StateDead" parent="StateMachine" node_paths=PackedStringArray("unit") instance=ExtResource("11_rb86x")]
unit = NodePath("../..")

[node name="AI" parent="." node_paths=PackedStringArray("default_action", "unit") instance=ExtResource("7_rb86x")]
default_action = NodePath("ActionIdle")
unit = NodePath("..")

[node name="ActionAttackMeele" parent="AI" instance=ExtResource("11_g0wty")]

[node name="ActionIdle" parent="AI" instance=ExtResource("8_g0wty")]

[node name="ActionWalk" parent="AI" instance=ExtResource("9_fayx6")]

[node name="CollisionShape2D" type="CollisionShape2D" parent="."]
shape = SubResource("CapsuleShape2D_iddm0")

[node name="TurnStartDelay" type="Timer" parent="."]
wait_time = 0.05
one_shot = true

[connection signal="area_entered" from="." to="." method="_on_area_entered"]
